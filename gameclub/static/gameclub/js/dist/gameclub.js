const BASE_URL="https://app3774.acapp.acwing.com.cn";export class GameClubSpan{constructor(i,s){this.id=i,this.os=s,this.$root_div=$("#"+this.id),this.$span_div=$('\n<div class="gc-home-span">\n    个人空间\n</div>\n'),this.$root_div.append(this.$span_div),this.start()}start(){this.get_info()}padding_info(i){console.log(i)}get_info(){$.ajax({url:`${BASE_URL}/gameclub/home/get_info/`,type:"post",headers:{Authorization:"Bearer "+localStorage.getItem("gc-access")},success:i=>{this.padding_info(i)},error:()=>{window.location.href=`${BASE_URL}/`}})}}class GameClubIndexBack{constructor(i){this.root=i,this.$back=$('<div class="gc-index-back"></div>'),this.root.$gc_index.append(this.$back),this.start()}start(){}}class GameClubIndexLogin{constructor(i){this.root=i,this.$login_box=$(`\n<div class="gc-index-login-box-wrap">\n<div class="gc-index-login-box-img">\n    <img src="https://app3774.acapp.acwing.com.cn/static/gameclub/images/index/hakase.jpg">\n</div>\n<div class="gc-index-login-box">\n    <div class="gc-index-login-box-title">\n        登录 GameClub\n    </div>\n    <div class="gc-index-login-box-form">\n        <div class="gc-index-login-box-email">\n            <div class="gc-index-login-box-email-logo">\n                <img src="${BASE_URL}/static/gameclub/images/index/email.svg">\n            </div>\n            <div class="gc-index-login-box-email-input">\n                <input type='email' placeholder="邮箱">\n            </div>\n        </div>\n        <div class="gc-index-login-box-password">\n            <div class="gc-index-login-box-passwd-logo">\n                <img src="${BASE_URL}/static/gameclub/images/index/passwd.svg">\n            </div>\n            <div class="gc-index-login-box-passwd-input">\n                <input type='password' placeholder="密码">\n            </div>\n        </div>\n        <div class="gc-index-login-box-message">\n            用户名或密码错误\n        </div>\n        <div class="gc-index-login-box-login-button">\n            <button>登录</button>\n        </div>\n    </div>\n    <div class="gc-index-login-box-other">\n        <div class="gc-index-login-box-other-register">\n            注册\n        </div>\n        <div class="gc-index-login-box-other-line">\n            |\n        </div>\n        <div class="gc-index-login-box-other-forget">\n            忘记密码?\n        </div>\n    </div>\n    <div class="gc-index-login-box-third">\n        <div class="gc-index-login-box-third-logo">\n            <img width="30" height="30" src="${BASE_URL}/static/gameclub/images/index/acapp.jpg">\n        </div>\n    </div>\n\n</div>\n</div>\n`),this.$login_box.hide(),this.root.$gc_index.append(this.$login_box),this.start()}start(){this.$email_box=this.$login_box.find(".gc-index-login-box-email"),this.$email_input=this.$email_box.find("input"),this.$password_box=this.$login_box.find(".gc-index-login-box-password"),this.$password_input=this.$password_box.find("input"),this.$login_button=this.$login_box.find(".gc-index-login-box-login-button > button"),this.$register_div=this.$login_box.find(".gc-index-login-box-other-register"),this.$forget_div=this.$login_box.find(".gc-index-login-box-other-forget"),this.$acwing_div=this.$login_box.find(".gc-index-login-box-third-logo"),this.$error_message=this.$login_box.find(".gc-index-login-box-message"),this.add_listening_events(),this.to_span()}add_listening_events(){this.$email_input.focus((()=>{this.email_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$password_input.focus((()=>{this.password_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$login_button.on("click",(()=>{this.login()})),this.$register_div.on("click",(()=>{window.location.href=`${BASE_URL}/gameclub/register/register/`})),this.$forget_div.on("click",(()=>{console.log("click forget div")})),this.$acwing_div.on("click",(()=>{console.log("click acwing_div")}))}login(){const i=this.$email_input.val(),s=this.$password_input.val();return""===i?(this.email_error_focus(!0),this.$email_input.attr("placeholder","邮箱为空"),void this.$email_input.addClass("gc-index-input-change")):""===s?(this.password_error_focus(!0),this.$password_input.attr("placeholder","密码为空"),void this.$password_input.addClass("gc-index-input-change")):void $.ajax({url:`${BASE_URL}/gameclub/jwt/token/`,type:"post",data:{username:i,password:s},success:i=>{localStorage.setItem("gc-access",i.access),localStorage.setItem("gc-refresh",i.refresh),this.refresh_tokens(),this.to_span()},error:()=>{this.password_error_focus(!0,!1),this.email_error_focus(!0,!1),this.$password_input.addClass("gc-index-input-change"),this.$email_input.addClass("gc-index-input-change"),this.$error_message.show()}})}password_error_focus(i,s){s&&this.clear_email_password(),i?this.$password_box.addClass("gc-index-login-box-input-error"):this.$password_box.addClass("gc-index-login-box-input-focus")}clear_email_password(){this.$email_box.hasClass("gc-index-login-box-input-error")&&this.$email_box.removeClass("gc-index-login-box-input-error"),this.$email_box.hasClass("gc-index-login-box-input-focus")&&this.$email_box.removeClass("gc-index-login-box-input-error"),this.$email_box.hasClass("gc-index-login-box-input-focus")&&this.$email_box.removeClass("gc-index-login-box-input-focus"),this.$password_box.hasClass("gc-index-login-box-input-error")&&this.$password_box.removeClass("gc-index-login-box-input-error"),this.$password_box.hasClass("gc-index-login-box-input-focus")&&this.$password_box.removeClass("gc-index-login-box-input-focus"),this.$email_input.hasClass("gc-index-input-change")&&this.$email_input.removeClass("gc-index-input-change"),this.$password_input.hasClass("gc-index-input-change")&&this.$password_input.removeClass("gc-index-input-change"),this.$email_input.attr("placeholder","邮箱"),this.$password_input.attr("placeholder","密码"),this.$error_message.hide()}email_error_focus(i,s){s&&this.clear_email_password(),i?this.$email_box.addClass("gc-index-login-box-input-error"):this.$email_box.addClass("gc-index-login-box-input-focus")}refresh_tokens(){setInterval((()=>{console.log("refresh tokens"),$.ajax({url:`${BASE_URL}/gameclub/jwt/token/refresh`,type:"POST",data:{refresh:localStorage.getItem("gc-refresh")},success:i=>{localStorage.setItem("gc-access",i.access)}})}),5e3)}to_span(){$.ajax({url:`${BASE_URL}/gameclub/home/check/`,type:"post",headers:{Authorization:"Bearer "+localStorage.getItem("gc-access")},success:i=>{window.location.href=`${BASE_URL}/gameclub/home/span/`},error:()=>{this.$login_box.show()}})}}export class GameClubIndex{constructor(i,s,e,o){this.id=i,this.os=s,localStorage.getItem("gc-access")||localStorage.setItem("gc-access",e),localStorage.getItem("gc-refresh")||localStorage.setItem("gc-refresh",o),this.$gc_index=$("\n<div class='gc-index'>\n</div>\n"),this.$root_div=$("#"+i),this.$root_div.append(this.$gc_index),this.start()}start(){this.back=new GameClubIndexBack(this),this.login_box=new GameClubIndexLogin(this)}}export class GameClubRegister{constructor(i,s){this.id=i,this.os=s,this.$root_div=$("#"+i),this.$gc_register=$(`\n<div class="gc-index-back"></div>\n<div class="gc-index-register-wrap">\n    <div class="gc-index-register-box">\n        <div class="gc-index-register-title">欢迎注册 GameClub</div>\n        <div class="gc-index-register-box-form">\n            <div class="gc-index-register-box-name">\n                <div class="gc-index-register-box-name-logo">\n                    <img src="${BASE_URL}/static/gameclub/images/register/name.svg">\n                </div>\n                <div class="gc-index-register-box-name-input">\n                    <input type='text' placeholder="昵称">\n                </div>\n            </div>\n            <div class="gc-index-register-box-email">\n                <div class="gc-index-register-box-email-logo">\n                    <img src="${BASE_URL}/static/gameclub/images/index/email.svg">\n                </div>\n                <div class="gc-index-register-box-email-input">\n                    <input type='email' placeholder="邮箱">\n                </div>\n            </div>\n\n            <div class="gc-index-register-box-password">\n                <div class="gc-index-register-box-password-logo">\n                    <img src="${BASE_URL}/static/gameclub/images/index/passwd.svg">\n                </div>\n                <div class="gc-index-register-box-password-input">\n                    <input type='password' placeholder="密码">\n                </div>\n            </div>\n\n            <div class="gc-index-register-box-password-confirm">\n                <div class="gc-index-register-box-password-confirm-logo">\n                    <img src="${BASE_URL}/static/gameclub/images/index/passwd.svg">\n                </div>\n                <div class="gc-index-register-box-password-confirm-input">\n                    <input type='password' placeholder="再次输入密码">\n                </div>\n            </div>\n\n            <div class="gc-index-register-box-confirm-email">\n                <div class="gc-index-register-box-confirm-email-logo">\n                    <img src="${BASE_URL}/static/gameclub/images/register/confirm.svg">\n                </div>\n                <div class="gc-index-register-box-confirm-email-input">\n                    <input type='text' placeholder="输入验证码">\n                </div>\n                <div class="gc-index-register-box-confirm-email-send">\n                    <button>发送验证码</button>\n                </div>\n            </div>\n            <div class="gc-index-register-box-message"></div>\n            <div class="gc-index-register-box-register-button">\n                <button>立即注册</button>\n            </div>\n        </div>\n        <div class="gc-index-register-box-other">\n            <div class="gc-index-register-box-other-login">\n                登录\n            </div>\n            <div class="gc-index-register-box-other-line">\n                |\n            </div>\n            <div class="gc-index-register-box-other-forget">\n                忘记密码?\n            </div>\n        </div>\n    </div>\n</div>\n`),this.$root_div.append(this.$gc_register),this.start()}start(){this.$name_box=this.$gc_register.find(".gc-index-register-box-name"),this.$name_input=this.$gc_register.find(".gc-index-register-box-name-input > input"),this.$email_box=this.$gc_register.find(".gc-index-register-box-email"),this.$email_input=this.$gc_register.find(".gc-index-register-box-email-input > input"),this.$password_box=this.$gc_register.find(".gc-index-register-box-password"),this.$password_input=this.$gc_register.find(".gc-index-register-box-password-input > input"),this.$password_confirm_box=this.$gc_register.find(".gc-index-register-box-password-confirm"),this.$password_confirm_input=this.$gc_register.find(".gc-index-register-box-password-confirm-input > input"),this.$confirm_email_box=this.$gc_register.find(".gc-index-register-box-confirm-email"),this.$confirm_email_input=this.$gc_register.find(".gc-index-register-box-confirm-email-input > input"),this.$confirm_email_send=this.$gc_register.find(".gc-index-register-box-confirm-email-send > button"),this.$register_button=this.$gc_register.find(".gc-index-register-box-register-button"),this.$other_login=this.$gc_register.find(".gc-index-register-box-other-login"),this.$other_forget=this.$gc_register.find(".gc-index-register-box-other-forget"),this.$error_message=this.$gc_register.find(".gc-index-register-box-message"),this.add_listening_events()}add_listening_events(){this.$name_input.focus((()=>{this.name_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$email_input.focus((()=>{this.email_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$password_input.focus((()=>{this.password_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$password_confirm_input.focus((()=>{this.password_confirm_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$confirm_email_input.focus((()=>{this.confirm_email_error_focus(!1,!0)})).blur((()=>{this.clear_email_password()})),this.$register_button.on("click",(()=>{this.register()})),this.$other_login.on("click",(()=>{window.location.href=`${BASE_URL}/`})),this.$other_forget.on("click",(()=>{console.log("click forget div")})),this.$confirm_email_send.on("click",(()=>{this.send()}))}register(){const i=this.$name_input.val(),s=this.$email_input.val(),e=this.$password_input.val(),o=this.$password_confirm_input.val(),n=this.$confirm_email_input.val();return""===i?(this.name_error_focus(!0,!0),this.$name_input.attr("placeholder","请填入昵称"),void this.$name_input.addClass("gc-index-input-change")):""===s?(this.email_error_focus(!0,!0),this.$email_input.attr("placeholder","请填入邮箱"),void this.$email_input.addClass("gc-index-input-change")):-1===s.search("@")?(this.email_error_focus(!0,!0),this.$error_message.text("邮箱格式错误"),void this.$error_message.show()):""===e?(this.password_error_focus(!0,!0),this.$password_input.attr("placeholder","请填入密码"),void this.$email_input.addClass("gc-index-input-change")):""===o?(this.password_confirm_error_focus(!0,!0),this.$password_confirm_input.attr("placeholder","请再次填入密码"),void this.$password_confirm_input.addClass("gc-index-input-change")):""===n?(this.confirm_email_error_focus(!0,!0),this.$confirm_email_input.attr("placeholder","请填入验证码"),void this.$confirm_email_input.addClass("gc-index-input-change")):e!==o?(this.password_error_focus(!0,!0),this.password_confirm_error_focus(!0,!1),this.$error_message.text("密码不一致"),void this.$error_message.show()):void $.ajax({url:`${BASE_URL}/gameclub/register/signup/`,type:"post",data:{name:i,email:s,password:e,confirm:n},success:i=>{"success"===i.result?window.location.href=i.url:(this.$error_message.val(i.result),this.$error_message.show())}})}send(){const i=this.$email_input.val();return""===i?(this.email_error_focus(!0,!0),this.$email_input.attr("placeholder","请填入邮箱"),void this.$email_input.addClass("gc-index-input-change")):-1===i.search("@")?(this.email_error_focus(!0,!0),this.$error_message.text("邮箱格式错误"),void this.$error_message.show()):void $.ajax({url:`${BASE_URL}/gameclub/register/send_email/`,type:"post",data:{email:i},success:i=>{"success"===i.result?this.change_send_button():(this.email_error_focus(!0,!0),this.$error_message.val(i.result),this.$error_message.show())}})}change_send_button(){this.clear_email_password(),this.$confirm_email_send.attr("disabled",!0);let i=60;this.$confirm_email_send.text("重新发送("+i+"s)"),this.$confirm_email_send.css("cursor","not-allowed");let s=setInterval((()=>{i-=1,this.$confirm_email_send.text("重新发送("+i+"s)"),this.$confirm_email_send.css("cursor","not-allowed")}),1e3);setTimeout((()=>{clearInterval(s),this.$confirm_email_send.attr("disabled",!1),this.$confirm_email_send.text("发送验证码"),this.$confirm_email_send.css("cursor","pointer")}),6e4)}confirm_email_error_focus(i,s){s&&this.clear_email_password(),i?this.$confirm_email_box.addClass("gc-index-login-box-input-error"):this.$confirm_email_box.addClass("gc-index-login-box-input-focus")}name_error_focus(i,s){s&&this.clear_email_password(),i?this.$name_box.addClass("gc-index-login-box-input-error"):this.$name_box.addClass("gc-index-login-box-input-focus")}password_confirm_error_focus(i,s){s&&this.clear_email_password(),i?this.$password_confirm_box.addClass("gc-index-login-box-input-error"):this.$password_confirm_box.addClass("gc-index-login-box-input-focus")}password_error_focus(i,s){s&&this.clear_email_password(),i?this.$password_box.addClass("gc-index-login-box-input-error"):this.$password_box.addClass("gc-index-login-box-input-focus")}email_error_focus(i,s){s&&this.clear_email_password(),i?this.$email_box.addClass("gc-index-login-box-input-error"):this.$email_box.addClass("gc-index-login-box-input-focus")}clear_email_password(){this.$name_box.hasClass("gc-index-login-box-input-error")&&this.$name_box.removeClass("gc-index-login-box-input-error"),this.$name_box.hasClass("gc-index-login-box-input-focus")&&this.$name_box.removeClass("gc-index-login-box-input-focus"),this.$email_box.hasClass("gc-index-login-box-input-error")&&this.$email_box.removeClass("gc-index-login-box-input-error"),this.$email_box.hasClass("gc-index-login-box-input-focus")&&this.$email_box.removeClass("gc-index-login-box-input-focus"),this.$email_box.hasClass("gc-index-login-box-input-focus")&&this.$email_box.removeClass("gc-index-login-box-input-focus"),this.$password_box.hasClass("gc-index-login-box-input-error")&&this.$password_box.removeClass("gc-index-login-box-input-error"),this.$password_box.hasClass("gc-index-login-box-input-focus")&&this.$password_box.removeClass("gc-index-login-box-input-focus"),this.$password_confirm_box.hasClass("gc-index-login-box-input-focus")&&this.$password_confirm_box.removeClass("gc-index-login-box-input-focus"),this.$password_confirm_box.hasClass("gc-index-login-box-input-error")&&this.$password_confirm_box.removeClass("gc-index-login-box-input-error"),this.$confirm_email_box.hasClass("gc-index-login-box-input-focus")&&this.$confirm_email_box.removeClass("gc-index-login-box-input-focus"),this.$confirm_email_box.hasClass("gc-index-login-box-input-error")&&this.$confirm_email_box.removeClass("gc-index-login-box-input-error"),this.$email_input.hasClass("gc-index-input-change")&&this.$email_input.removeClass("gc-index-input-change"),this.$password_input.hasClass("gc-index-input-change")&&this.$password_input.removeClass("gc-index-input-change"),this.$password_confirm_input.hasClass("gc-index-input-change")&&this.$password_confirm_input.removeClass("gc-index-input-change"),this.$confirm_email_input.hasClass("gc-index-input-change")&&this.$confirm_email_input.removeClass("gc-index-input-change"),this.$name_input.hasClass("gc-index-input-change")&&this.$name_input.removeClass("gc-index-input-change"),this.$email_input.attr("placeholder","邮箱"),this.$password_input.attr("placeholder","密码"),this.$password_confirm_box.attr("placeholder","再次输入密码"),this.$confirm_email_input.attr("placeholder","输入验证码"),this.$name_input.attr("placeholder","昵称"),this.$error_message.hide()}}
